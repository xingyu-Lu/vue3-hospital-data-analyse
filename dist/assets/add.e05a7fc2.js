var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,d)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):a[l]=d;import{K as t,V as n,u as m,r as i,j as u,h as c,t as p,i as h,L as f,M as g,W as b,X as k,Y as w,Z as _,E as F,N as R,O as V,F as j,w as y,o as v,d as C,m as O,c as x,G as q,H as A,e as U,n as P}from"./vendor.be2f38ff.js";/* empty css                *//* empty css                     *//* empty css                 *//* empty css                          *//* empty css                    *//* empty css                 */import"./wangEditor.dcd8f006.js";import{a as E}from"./index.1d977e39.js";const I={name:"admin_add",setup(){const e=t(null),f=t(!1),g=t(!0),b=n(),k=m(),{id:w}=b.query,_=i({token:"Bearer "+E("token")||"",id:w,adminForm:{name:"",password:"",new_password:"",status:"1",checkedRole:[]},role_list:[],rules:{name:[{required:"true",message:"账号名称必须",trigger:["change"]}],password:[{required:!0,message:"账号密码必须",trigger:["change"]}],new_password:[{required:!1,message:"账号密码必须",trigger:["change"]}],status:[{required:"true",message:"账号状态必须",trigger:["change"]}],checkedRole:[{required:!0,message:"角色必须",trigger:["change"]}]}});u((()=>{F(),w&&c.get(`/api/back/admins/${w}`).then((e=>{_.adminForm={name:e.data.name,checkedRole:e.data.role,password:e.data.password,status:String(e.data.status)}}))}));const F=()=>{c.get("/api/back/roles").then((e=>{_.role_list=e.data}))};return R=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&s(e,l,a[l]);if(d)for(var l of d(a))o.call(a,l)&&s(e,l,a[l]);return e})({},p(_)),a(R,l({adminRef:e,submitAdd:()=>{e.value.validate((e=>{if(e){let e=c.post,a={name:_.adminForm.name,password:_.adminForm.password,new_password:_.adminForm.new_password,status:_.adminForm.status,role_ids:_.adminForm.checkedRole};if(a.name.length>30)return void h.error("账号名称不能超过30个字符");if(a.status.length>30)return void h.error("账号密码不能超过30个字符");let l="/api/back/admins";w&&(e=c.put,l=`/api/back/admins/${w}`),e(l,a).then((()=>{h.success(w?"修改成功":"添加成功"),k.push({path:"/admin"})}))}}))},checkRoleAll:f,isRoleIndeterminate:g,handleCheckRoleAllChange:e=>{e?(_.adminForm.checkedRole=[],_.role_list.forEach((e=>{_.adminForm.checkedRole.push(e.id)}))):_.adminForm.checkedRole=[],g.value=!1},handleCheckedRolesChange:e=>{const a=e.length;f.value=a===_.role_list.length,g.value=a>0&&a<_.role_list.length},id:w}));var R}},S=U("开启"),$=U("禁用");I.render=function(e,a,l,d,r,o){const s=f,t=g,n=b,m=k,i=w,u=_,c=F,p=R,h=V;return v(),j(h,{style:{"min-height":"100%"}},{default:y((()=>[C(p,{model:e.adminForm,rules:e.rules,ref:"adminRef","label-width":"100px"},{default:y((()=>[C(t,{label:"账号",prop:"name"},{default:y((()=>[C(s,{modelValue:e.adminForm.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.adminForm.name=a),placeholder:"请输入账号名称"},null,8,["modelValue"])])),_:1}),C(t,{label:"密码",prop:"password"},{default:y((()=>[d.id?(v(),j(s,{key:0,modelValue:e.adminForm.password,"onUpdate:modelValue":a[1]||(a[1]=a=>e.adminForm.password=a),placeholder:"请输入密码",disabled:""},null,8,["modelValue"])):(v(),j(s,{key:1,modelValue:e.adminForm.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.adminForm.password=a),placeholder:"请输入密码"},null,8,["modelValue"]))])),_:1}),d.id?(v(),j(t,{key:0,label:"新密码",prop:"new_password"},{default:y((()=>[C(s,{modelValue:e.adminForm.new_password,"onUpdate:modelValue":a[3]||(a[3]=a=>e.adminForm.new_password=a),placeholder:"请输入新密码"},null,8,["modelValue"])])),_:1})):O("v-if",!0),C(t,{label:"角色",prop:"checkedRole"},{default:y((()=>[O(' <el-checkbox v-model="checkRoleAll" :indeterminate="isRoleIndeterminate"\r\n\t\t\t\t\t@change="handleCheckRoleAllChange">Check all</el-checkbox> '),C(m,{modelValue:e.adminForm.checkedRole,"onUpdate:modelValue":a[4]||(a[4]=a=>e.adminForm.checkedRole=a),onChange:d.handleCheckedRolesChange},{default:y((()=>[(v(!0),x(A,null,q(e.role_list,((e,a)=>(v(),j(n,{key:e.id,label:e.id},{default:y((()=>[U(P(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),C(t,{label:"状态",prop:"status"},{default:y((()=>[C(u,{modelValue:e.adminForm.status,"onUpdate:modelValue":a[5]||(a[5]=a=>e.adminForm.status=a)},{default:y((()=>[C(i,{label:"1"},{default:y((()=>[S])),_:1}),C(i,{label:"0"},{default:y((()=>[$])),_:1})])),_:1},8,["modelValue"])])),_:1}),C(t,null,{default:y((()=>[C(c,{type:"primary",onClick:a[6]||(a[6]=e=>d.submitAdd())},{default:y((()=>[U(P(d.id?"立即修改":"立即创建"),1)])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})};export{I as default};
