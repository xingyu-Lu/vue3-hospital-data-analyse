var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r;import{K as t,V as n,u as m,r as i,j as u,h as p,t as c,i as h,L as f,M as g,W as b,X as w,Y as _,Z as k,E as F,N as V,O as R,F as j,w as y,o as v,d as O,m as C,c as q,G as U,H as x,e as P,n as A}from"./vendor.c477240a.js";/* empty css                *//* empty css                     *//* empty css                 *//* empty css                          *//* empty css                    *//* empty css                 */import"./wangEditor.dcd8f006.js";import{a as E}from"./index.53a7ebbf.js";const I={name:"admin_add",setup(){const e=t(null),f=t(!1),g=t(!0),b=n(),w=m(),{id:_}=b.query,k=i({token:"Bearer "+E("token")||"",id:_,adminForm:{name:"",password:"",new_password:"",status:"1",checkedRole:[]},role_list:[],rules:{name:[{required:"true",message:"账号名称必须",trigger:["change"]}],password:[{required:!0,message:"账号密码必须",trigger:["change"]}],new_password:[{required:!1,message:"账号密码必须",trigger:["change"]}],status:[{required:"true",message:"账号状态必须",trigger:["change"]}],checkedRole:[{required:!0,message:"角色必须",trigger:["change"]}]}});u((()=>{F(),_&&p.get(`/api/back/admins/${_}`).then((e=>{k.adminForm={name:e.data.name,checkedRole:e.data.role,password:e.data.password,status:String(e.data.status)}}))}));const F=()=>{p.get("/api/back/roles").then((e=>{k.role_list=e.data}))};return V=((e,a)=>{for(var l in a||(a={}))d.call(a,l)&&s(e,l,a[l]);if(r)for(var l of r(a))o.call(a,l)&&s(e,l,a[l]);return e})({},c(k)),a(V,l({adminRef:e,submitAdd:()=>{e.value.validate((e=>{if(e){let e=p.post,a={name:k.adminForm.name,password:k.adminForm.password,new_password:k.adminForm.new_password,status:k.adminForm.status,role_ids:k.adminForm.checkedRole};if(a.name.length>30)return void h.error("账号名称不能超过30个字符");if(a.status.length>30)return void h.error("账号密码不能超过30个字符");let l="/api/back/admins";_&&(e=p.put,l=`/api/back/admins/${_}`),e(l,a).then((()=>{h.success(_?"修改成功":"添加成功"),w.push({path:"/admin"})}))}}))},checkRoleAll:f,isRoleIndeterminate:g,handleCheckRoleAllChange:e=>{e?(k.adminForm.checkedRole=[],k.role_list.forEach((e=>{k.adminForm.checkedRole.push(e.id)}))):k.adminForm.checkedRole=[],g.value=!1},handleCheckedRolesChange:e=>{const a=e.length;f.value=a===k.role_list.length,g.value=a>0&&a<k.role_list.length},id:_}));var V}},S=P("开启"),$=P("禁用");I.render=function(e,a,l,r,d,o){const s=f,t=g,n=b,m=w,i=_,u=k,p=F,c=V,h=R;return v(),j(h,{style:{"min-height":"100%"}},{default:y((()=>[O(c,{model:e.adminForm,rules:e.rules,ref:"adminRef","label-width":"100px"},{default:y((()=>[O(t,{label:"账号",prop:"name"},{default:y((()=>[O(s,{modelValue:e.adminForm.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.adminForm.name=a),placeholder:"请输入账号名称"},null,8,["modelValue"])])),_:1}),O(t,{label:"密码",prop:"password"},{default:y((()=>[r.id?(v(),j(s,{key:0,modelValue:e.adminForm.password,"onUpdate:modelValue":a[1]||(a[1]=a=>e.adminForm.password=a),placeholder:"请输入密码",disabled:""},null,8,["modelValue"])):(v(),j(s,{key:1,modelValue:e.adminForm.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.adminForm.password=a),placeholder:"请输入密码"},null,8,["modelValue"]))])),_:1}),r.id?(v(),j(t,{key:0,label:"新密码",prop:"new_password"},{default:y((()=>[O(s,{modelValue:e.adminForm.new_password,"onUpdate:modelValue":a[3]||(a[3]=a=>e.adminForm.new_password=a),placeholder:"请输入新密码"},null,8,["modelValue"])])),_:1})):C("",!0),O(t,{label:"角色",prop:"checkedRole"},{default:y((()=>[O(m,{modelValue:e.adminForm.checkedRole,"onUpdate:modelValue":a[4]||(a[4]=a=>e.adminForm.checkedRole=a),onChange:r.handleCheckedRolesChange},{default:y((()=>[(v(!0),q(x,null,U(e.role_list,((e,a)=>(v(),j(n,{key:e.id,label:e.id},{default:y((()=>[P(A(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),O(t,{label:"状态",prop:"status"},{default:y((()=>[O(u,{modelValue:e.adminForm.status,"onUpdate:modelValue":a[5]||(a[5]=a=>e.adminForm.status=a)},{default:y((()=>[O(i,{label:"1"},{default:y((()=>[S])),_:1}),O(i,{label:"0"},{default:y((()=>[$])),_:1})])),_:1},8,["modelValue"])])),_:1}),O(t,null,{default:y((()=>[O(p,{type:"primary",onClick:a[6]||(a[6]=e=>r.submitAdd())},{default:y((()=>[P(A(r.id?"立即修改":"立即创建"),1)])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})};export{I as default};
